<!DOCTYPE html>
<html>
    <head>
        <title>is true true or is false true?</title>
    </head>
    <body>
        <h1>Is true true or is false true?</h1>
        <p>Your goal is simple, guess true or false, are you correct, or is true false?</p>
        <div id = "game">
            <h3 id = "question">true?</h3>
            <button id="true">True</button>
            <button id="false">False</button>
            <h4 id = "streak">Streak: 0</h4>
        </div>
    </body>
</html>
<style>
    *{
        text-align: center;
    }
</style>
<script>
    let correctAnswer = Math.random() >= 0.5;
    let Streak = 0;
    let statevar = 1;
    
    const question = document.getElementById("question");
    const streakText = document.getElementById("streak");
    const trueButton = document.getElementById("true");
    const falseButton = document.getElementById("false");
    const correctAudio = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/correct.mp3");
    const falseAudio = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/wrong.mp3");
    const normalSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/Normal.wav");
    const mediumSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/medium.wav");
    const hardSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/hard.wav");
    const harderSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/harder.wav");
    const extremeSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/extreme.wav");
    const HOWSong = new Audio("https://that-one-axolotl.github.io/falseistrue/sounds/HOW.wav");
    let song = normalSong;
    

    trueButton.addEventListener("click", () => {
        correctAudio.pause();
        falseAudio.pause();
        correctAudio.currentTime = 0;
        falseAudio.currentTime = 0;
        if (correctAnswer == true){
            Streak += 1;
            streakText.textContent = `Streak: ${Streak}`;
            correctAudio.play();
        }
        else{
            Streak = 0;
            streakText.textContent = `Streak: ${Streak}`;
            falseAudio.play();
        }
        correctAnswer = Math.random() >= 0.5;
        question.textContent = `${Math.random() >= 0.5}?`
        statevar = changeState(Streak);
        playNextTrack();
    }) 

    falseButton.addEventListener("click", () => {
        correctAudio.pause();
        falseAudio.pause();
        correctAudio.currentTime = 0;
        falseAudio.currentTime = 0;
        if (correctAnswer == false){
            Streak += 1;
            streakText.textContent = `Streak: ${Streak}`;
            correctAudio.play();
        }
        else{
            Streak = 0;
            streakText.textContent = `Streak: ${Streak}`;
            falseAudio.play();
        }
        correctAnswer = Math.random() >= 0.5;
        question.textContent = `${Math.random() >= 0.5}?`
        statevar = changeState(Streak);
        playNextTrack();
    })

    function changeState(streak){
        if (streak >= 0){
            statevar = 1;
        }
        if (streak >= 2){
            statevar = 2;
        }
        if (streak >= 5){
            statevar = 3;
        }
        if (streak >= 7){
            statevar = 4;
        }
        if (streak >= 10){
            statevar = 5;
            //FINAL BOSS
        }
        if (streak >= 12){
            statevar = 6;
            //OH NO
        }
        return(statevar);
    }

    //audio
    function getSongByState(state) {
        switch (state) {
            case 1: return normalSong;
            case 2: return mediumSong;
            case 3: return hardSong;
            case 4: return harderSong;
            case 5: return extremeSong;
            case 6: return HOWSong;
            default: return normalSong;
        }
    }

    function playNextTrack() {
        const nextSong = getSongByState(statevar);

        if (song && song !== nextSong) {
            song.pause();
            song.currentTime = 0;
            song.removeEventListener("ended", playNextTrack);
        }

        song = nextSong;
        song.removeEventListener("ended", playNextTrack); // prevent stacking
        song.addEventListener("ended", playNextTrack);
        song.play().catch(err => console.error("Playback failed:", err));
    }


</script>